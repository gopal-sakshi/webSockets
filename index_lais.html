<!DOCTYPE html>
<html>

<head>    
    <script src="https://cdn.socket.io/4.5.3/socket.io.min.js" integrity="sha384-WPFUvHkB1aHA5TDSZi6xtDgkF0wXJcIIxXhC6h8OT8EH3fC5PWro5pWJ1THjcfEi" crossorigin="anonymous"></script>
</head>

<body>
    <div class="container">
        <div class="event-listeners23">
            <input id="msgContent" placeholder="enter msg">
            <button onclick="sendMsg23()">sendMsg23</button>
        </div>
    </div>
    <div class="chat-window">
        <div id="messages84"></div>
    </div>
    
    <script>
        var options = {
            url: "http://localhost:18181/",
            path: "/liveagent",
            query: {
                email: "baba@gmail.com",
                name: "baba",
                sessionId: "8763b567-89d9-4365-bb0e-4d74bc3be86c",
                orgId: "9f35e285-f4aa-4d56-bda3-9f2f576a629d",
                skill: "billing"
            }
        }
        var socket = io(options.url, {
            transports: ['websocket'],
            path: options.path,
            query: options.query
        });
        
        var chatContent = [
            { msg:'welcome to chat23', type:0 }
        ];

        function updateMessages() {
            document.getElementById('messages84').replaceChildren();
            for (let i=0; i<chatContent.length; i++) {
                const div23 = document.createElement("div");
                div23.innerHTML = chatContent[i].msg;
                document.getElementById('messages84').appendChild(div23);
            }
        }


        function sendMsg23() {
            var msgContentVal = document.getElementById('msgContent').value;
            socket.emit("client-query", { msg: msgContentVal });
            chatContent.push({msg:msgContentVal, type:0});
            updateMessages();
        }

        /******************* event listeners ***************************/
        socket.on("notify-no-agents", (...args) => {
            console.log('notify-no-agents', args);
        });
        socket.on("notify-agent-response", (...args) => {
            chatContent.push({msg: args[0].msg, type:2});
            updateMessages();
            console.log('notify-agent-response', args);
        });
        socket.on("notify-agent-disconnect", (...args) => {
            console.log('notify-agent-disconnect', args);
        });
        socket.on("notify-agent-close-conversation", (...args) => {
            console.log('notify-agent-close-conversation', args);
        });
        socket.on("notify-agent-updated", (...args) => {
            console.log('notify-agent-updated', args);
        });
        socket.on("notify-wait-for-agents", (...args) => {
            console.log('notify-wait-for-agents', args);
        });
        socket.on("notify-agent-assigned", (...args) => {
            console.log('notify-agent-assigned', args);
        });
        /******************* event listeners ***************************/
    </script>

</body>

</html>